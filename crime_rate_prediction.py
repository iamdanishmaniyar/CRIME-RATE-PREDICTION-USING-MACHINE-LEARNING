# -*- coding: utf-8 -*-
"""crime_rate_prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1JlIZv9Y0cUO0rmdWZmdQ9RpbOMP3QC0v

CRIME RATE PREDICTION USING MACHINE LEARNING
"""

import pandas as pd

ds =pd.read_csv("rk_dataset1.csv")

ds

ds.head(5)

ds.info()

X = ds.drop(["STATE/UT","DISTRICT","MURDER","RAPE","THEFT","pre"], axis = 1)

X

Y=ds["MURDER"]

Y

from sklearn.model_selection import train_test_split

X_train,X_test,Y_train,Y_test = train_test_split(X,Y,test_size=0.2,random_state=42)

X_train.shape

X_test.shape

from sklearn.linear_model import LinearRegression

lr = LinearRegression()

lr.fit(X_train,Y_train)

Y_predict = lr.predict(X_test)

print(Y_test.values)

print(Y_predict)

from sklearn.metrics import mean_squared_error

print("Mean Squared Error:",mean_squared_error(Y_test,Y_predict))

print("Weights:",lr.coef_)

print("Intercept:",lr.intercept_)

import pickle

file=open("Murder.pkl","wb")

pickle.dump(lr,file)

file.close()

import pickle

file = open("Murder.pkl","rb")

clf = pickle.load(file)

file.close()

Year = float(input("Enter thye year that you want to calculate: "))

input_features = [[Year]]

Murder_predict=clf.predict(input_features)

print("Murder:",Murder_predict)

